---
import { ViewTransitions } from 'astro:transitions'
import Theme from '../components/Theme.astro'
import '@fontsource-variable/syne'
import '@fontsource/atkinson-hyperlegible/400.css'
import '@fontsource/atkinson-hyperlegible/400-italic.css'
import '@fontsource/atkinson-hyperlegible/700.css'
---

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width" />
  <meta name="generator" content={Astro.generator} />
  <link rel="sitemap" href="/sitemap-index.xml" />
  <slot />
  <Theme />
  <ViewTransitions />
</head>

<script>
  document.addEventListener('astro:before-preparation', (event) => {
    const dir = (event.sourceElement as HTMLElement)?.dataset.direction
    if (dir) {
      history.replaceState({ ...history.state, direction: dir }, '')
      event.direction = dir
    } else {
      const savedDir = history.state?.direction
      if (savedDir) {
        event.direction =
          event.direction === 'back'
            ? savedDir === 'back'
              ? 'forward'
              : 'back'
            : savedDir
      }
    }
  })
</script>
